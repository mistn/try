<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive</title>
    <!-- ä½¿ç”¨ Tailwind CSS ä½œä¸ºåŸºç¡€æ ·å¼æ¡†æ¶ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #000000;
            --transition-smooth: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow: hidden; 
            user-select: none;
            transition: filter 0.8s ease;
        }

        /* æ¡Œé¢ç«¯ç¡¬æ€§æ‹¦æˆª */
        #mobileOverlay { display: none; }
        @media (max-width: 768px), (hover: none) and (pointer: coarse) {
            #mobileOverlay { display: flex; }
        }

        body.dark-mode { filter: invert(1) hue-rotate(180deg); }
        body.dark-mode img, body.dark-mode canvas, body.dark-mode #blackHoleContainer { filter: invert(1) hue-rotate(180deg); }

        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .glass-panel {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .font-wenkai {
            font-family: "LXGW WenKai Screen", serif;
            letter-spacing: 1px;
            line-height: 1.8;
        }

        .ios-toggle {
            appearance: none; width: 50px; height: 30px; background: var(--text-color);
            border-radius: 30px; position: relative; cursor: pointer; outline: none;
            transition: 0.3s; border: 2px solid var(--text-color);
        }
        .ios-toggle::after {
            content: ''; position: absolute; top: 2px; left: 22px; width: 22px; height: 22px;
            background-color: var(--bg-color); border-radius: 50%;
            transition: left 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6), background-color 0.3s;
        }
        .ios-toggle:not(:checked) { background: var(--bg-color); }
        .ios-toggle:not(:checked)::after { left: 2px; background-color: var(--text-color); }

        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%;
            background: #000; cursor: pointer; margin-top: -8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #e5e7eb; border-radius: 2px;
        }

        @keyframes toastFade {
            0% { opacity: 0; transform: translate(-50%, -20px); }
            10% { opacity: 1; transform: translate(-50%, 0); }
            90% { opacity: 1; transform: translate(-50%, 0); }
            100% { opacity: 0; transform: translate(-50%, -20px); }
        }
        .toast-anim { animation: toastFade var(--toast-duration, 3s) forwards; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px) rotate(-1deg); }
            40%, 80% { transform: translateX(5px) rotate(1deg); }
        }
        .shake-anim { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; color: #dc2626; }

        #spotlightOverlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: radial-gradient(circle 200px at var(--x, 50%) var(--y, 50%), transparent 0%, rgba(0,0,0,0.85) 100%);
            pointer-events: none; z-index: 40; opacity: 0; transition: opacity 0.5s ease;
        }
        .spotlight-active #spotlightOverlay { opacity: 1; }
        .spotlight-target { position: relative; z-index: 50 !important; background: white; border-radius: 8px; padding: 0 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }

        .step-container {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.8s ease;
        }
        .step-container.active { opacity: 1; pointer-events: auto; }

        #pullCord {
            position: fixed; top: -10px; right: 80px; width: 4px; height: 120px;
            background: #d1d5db; z-index: 100; transform-origin: top center; cursor: grab;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }
        #pullCord::after {
            content: ''; position: absolute; bottom: -12px; left: -6px; width: 16px; height: 16px;
            background: #9ca3af; border-radius: 50%; box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        .cord-swing { animation: swing 1s cubic-bezier(0.25, 1, 0.5, 1); }
        @keyframes swing {
            0% { transform: rotate(0deg) scaleY(1); }
            30% { transform: rotate(5deg) scaleY(1.1); }
            60% { transform: rotate(-3deg) scaleY(0.95); }
            80% { transform: rotate(1deg) scaleY(1.02); }
            100% { transform: rotate(0deg) scaleY(1); }
        }

        .scratch-container { position: relative; width: 160px; height: 40px; }
        #scratchCanvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer; z-index: 10; border-radius: 4px; }
        #secretPasswordDisplay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-family: monospace; font-size: 1.2rem; letter-spacing: 2px; color: black; background: #f3f4f6; border-radius: 4px; z-index: 5; border: 1px dashed #ccc;}

        /* é€¼çœŸäººæœºéªŒè¯çš„ä¸“å±æ ·å¼ */
        .rc-tile-wrapper { background: white; overflow: hidden; position: relative; cursor: pointer; }
        .rc-tile {
            /* èƒŒæ™¯å›¾å°†é€šè¿‡ JS åŠ¨æ€èµ‹äºˆï¼Œå®ç°åˆ‡æ¢æ•ˆæœ */
            background-size: 400% 400%;
            width: 100%; height: 100%;
            transition: transform 0.1s ease;
        }
        .rc-tile-wrapper.selected .rc-tile { transform: scale(0.85); }
        .rc-tile-check {
            position: absolute; top: 3px; left: 3px;
            width: 20px; height: 20px;
            background: #1a73e8; border-radius: 50%; color: white;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; transform: scale(0); transition: all 0.1s ease;
            z-index: 10; box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        .rc-tile-wrapper.selected .rc-tile-check { opacity: 1; transform: scale(1); }

        #blackHole {
            width: 150px; height: 150px; border-radius: 50%; background: radial-gradient(circle at center, #000 0%, #1a1a1a 40%, transparent 70%);
            box-shadow: 0 0 50px 20px rgba(0,0,0,0.8), inset 0 0 20px rgba(255,255,255,0.2);
            animation: rotateHole 4s linear infinite; display: flex; align-items: center; justify-content: center;
        }
        @keyframes rotateHole { 100% { transform: rotate(360deg); } }
        .sucked-in { transform: scale(0) rotate(720deg) !important; opacity: 0 !important; filter: blur(10px); transition: all 1s cubic-bezier(0.5, 0, 0, 1) !important; }

        .magnetic-btn {
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            will-change: transform;
        }
    </style>
</head>
<body class="w-screen h-screen relative">

    <!-- ç§»åŠ¨ç«¯æ‹¦æˆªå±‚ -->
    <div id="mobileOverlay" class="fixed inset-0 bg-black text-white z-[9999] flex-col items-center justify-center p-6 text-center">
        <h1 class="text-3xl font-bold mb-4 tracking-widest">ç”µè„‘ä¸“å±</h1>
        <p class="text-gray-400 text-sm tracking-wider">è¿™ç©æ„å„¿éœ€è¦ç”¨é¼ æ ‡ç²¾ç»†æ“ä½œï¼Œ<br>æ‰‹æœºä¸Šå®åœ¨æ²¡æ³•ç©å‘€ï¼Œå»å€Ÿå°ç”µè„‘å§~</p>
    </div>

    <div id="spotlightOverlay"></div>
    <div id="pullCord"></div>

    <div id="failCounterWidget" class="fixed bottom-6 right-8 z-40 text-[10px] text-gray-300 font-mono tracking-widest hidden transition-opacity duration-1000">
        ç¿»è½¦æ¬¡æ•°: <span id="failCount" class="text-black font-bold">0</span>
    </div>

    <div id="toast" class="fixed top-10 left-1/2 z-50 hidden glass-panel px-6 py-3 rounded-full text-sm font-medium tracking-widest pointer-events-none text-black border border-gray-200 shadow-sm whitespace-nowrap"></div>

    <!-- å…³å¡ 1ï¼šé˜²è¯¯è§¦å…³é—­ -->
    <div id="step1" class="step-container active bg-gray-50/50">
        <div class="glass-panel w-[400px] h-[300px] rounded-3xl flex flex-col items-center justify-center relative shadow-2xl">
            <button id="runawayBtn" class="absolute top-5 right-5 w-8 h-8 flex items-center justify-center rounded-full text-gray-400 hover:text-black transition-colors" style="transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M1 1L13 13M1 13L13 1"></path></svg>
            </button>
            <h1 class="text-3xl font-light tracking-tight mb-4 kinetic-title inline-block">ç¬¬ä¸€å…³</h1>
            <p class="text-sm text-gray-500 tracking-widest">æŠŠå³ä¸Šè§’é‚£ä¸ªå‰å‰ç‚¹æ‰</p>
        </div>
    </div>

    <!-- å…³å¡ 2ï¼šé˜…è¯»é™é€Ÿ -->
    <div id="step2" class="step-container bg-white">
        <div class="w-[500px] h-[75vh] max-h-[600px] flex flex-col relative">
            <h2 class="text-2xl font-bold mb-6 text-center tracking-tighter kinetic-title inline-block origin-bottom">å¿…è¯»åºŸè¯</h2>
            
            <div id="tosContainer" class="flex-1 overflow-y-auto hide-scrollbar border-y border-gray-100 relative bg-white">
                <div id="tosGhost" class="w-full py-6 px-4 font-wenkai text-transparent select-none pointer-events-none"></div>
                <div id="tosBlurred" class="absolute top-0 left-0 w-full py-6 px-4 font-wenkai text-gray-800 blur-[5px] opacity-40 select-none pointer-events-none"></div>
                <div id="tosClear" class="absolute top-0 left-0 w-full py-6 px-4 font-wenkai text-gray-800 select-none pointer-events-none" 
                     style="-webkit-mask-image: radial-gradient(circle 80px at var(--mx, -100px) var(--my, -100px), black 40%, transparent 100%);">
                </div>
            </div>

            <div class="mt-6 flex justify-center z-10">
                <button id="agreeBtn" class="magnetic-btn px-8 py-3 bg-gray-200 text-gray-400 rounded-full text-sm font-semibold tracking-widest cursor-not-allowed transition-colors duration-500">
                    æˆ‘éƒ½çœ‹å®Œäº†
                </button>
            </div>
        </div>
    </div>

    <!-- å…³å¡ 3ï¼šç»ˆç«¯ç»‘å®š -->
    <div id="step3" class="step-container bg-white">
        <div class="w-[500px] flex flex-col items-center">
            
            <div id="step3-state1" class="w-full flex flex-col items-center transition-opacity duration-500">
                <p class="text-sm text-gray-400 mb-10 text-center">æ‰‹æ»‘é€‰ä¸€ä¸‹ä½ çš„æ‰‹æœºå·å‘—ï¼š</p>
                <div class="text-4xl font-mono tracking-widest mb-8 text-black" id="phoneDisplay">13000000000</div>
                <input type="range" id="phoneSlider" min="13000000000" max="19999999999" value="13000000000" step="1" class="w-full mb-6">
                <p class="text-xs text-gray-400 mb-12">ï¼ˆæ•²ä¸äº†é”®ç›˜ï¼Œåªèƒ½æ»‘ï¼‰</p>
                <button id="sendCodeBtn" class="magnetic-btn px-10 py-3 bg-black text-white rounded-full text-sm font-semibold tracking-widest hover:scale-105">
                    è·å–éªŒè¯ç 
                </button>
            </div>

            <div id="step3-state2" class="w-full flex flex-col items-center hidden opacity-0 transition-opacity duration-500">
                <p class="text-sm text-gray-400 mb-6 text-center">éªŒè¯ç å¤§æ¦‚å·²ç»å‘åˆ°è¿™ä¸ªå·ä¸Šäº†ï¼š<br><span id="confirmPhoneDisplay" class="text-2xl font-mono font-bold text-black mt-3 inline-block tracking-widest"></span></p>
                <input type="text" id="smsCodeInput" placeholder="åœ¨è¿™æ•²éªŒè¯ç " maxlength="6" class="w-2/3 border-b border-gray-300 py-3 text-center text-xl focus:outline-none transition-colors bg-transparent mb-8 tracking-[0.5em] font-mono" data-spotlight="true">
                <button id="verifyCodeBtn" class="magnetic-btn px-10 py-3 bg-black text-white rounded-full text-sm font-semibold tracking-widest hover:scale-105 mb-6">
                    ç¡®å®š
                </button>
                <button id="backToPhoneBtn" class="text-xs text-gray-400 hover:text-black underline underline-offset-4 transition-colors">
                    å·ç æ»‘é”™äº†ï¼Œé‡é€‰
                </button>
            </div>
        </div>
    </div>

    <!-- å…³å¡ 4ï¼šå®‰å…¨å¯†é’¥é…ç½® -->
    <div id="step4" class="step-container bg-white">
        <div class="w-[450px] flex flex-col">
            <h2 class="text-3xl font-bold mb-2 tracking-tighter kinetic-title inline-block origin-bottom">è®¾ä¸ªå¯†ç </h2>
            <p class="text-sm text-gray-400 mb-8">å’±ä»¬æ¥è®¾ä¸ªåˆé’»ç‚¹çš„å¯†ç å§ã€‚</p>
            
            <div class="flex items-end gap-4 mb-6">
                <input type="password" id="passwordInput" placeholder="åœ¨è¿™é‡Œæ•²å¯†ç ..." class="flex-1 border-b border-gray-300 py-3 text-lg focus:outline-none transition-colors bg-transparent placeholder-gray-300" data-spotlight="true">
                <div class="scratch-container">
                    <div id="secretPasswordDisplay">****</div>
                    <canvas id="scratchCanvas"></canvas>
                </div>
            </div>

            <div id="rulesContainer" class="flex flex-col gap-3 text-sm"></div>
            <button id="pwdNextBtn" class="magnetic-btn mt-10 px-8 py-3 bg-black text-white rounded-full text-sm font-semibold opacity-0 pointer-events-none transition-opacity duration-500 self-start hover:scale-105">
                æå®šï¼Œä¸‹ä¸€æ­¥
            </button>
        </div>
    </div>

    <!-- å…³å¡ 5ï¼šè¡Œä¸ºéªŒè¯ -->
    <div id="step5" class="step-container bg-gray-50">
        <div class="w-[600px] glass-panel p-10 rounded-3xl flex flex-col items-center">
            <h2 class="text-xl font-semibold mb-2 tracking-wide kinetic-title inline-block origin-bottom">æ‰‹ç¨³æµ‹è¯•</h2>
            <p class="text-xs text-gray-500 mb-8">é¡ºç€çº¿æŠŠå°é»‘ç‚¹æ‹–åˆ°ç»ˆç‚¹ã€‚æ‰‹åˆ«æŠ–ï¼Œå‡ºè½¨äº†å°±å¾—é‡æ¥ã€‚</p>
            <div class="relative w-full h-[150px] border border-gray-100 rounded-xl bg-white flex items-center justify-center overflow-hidden">
                <svg id="captchaSvg" class="absolute w-full h-full pointer-events-none" viewBox="0 0 500 150">
                    <path d="M 50,75 C 150,180 350,-30 450,75" fill="none" stroke="#d1d5db" stroke-width="2" stroke-linecap="round" class="pointer-events-none" />
                    <path id="captchaPath" d="M 50,75 C 150,180 350,-30 450,75" fill="none" stroke="rgba(0,0,0,0.01)" stroke-width="16" stroke-linecap="round" style="pointer-events: stroke;" class="pointer-events-auto" />
                    <circle cx="450" cy="75" r="8" fill="none" stroke="#000" stroke-width="2"/>
                </svg>
                <div id="captchaDot" class="absolute w-5 h-5 bg-black rounded-full cursor-grab" style="left: 40px; top: 65px; transition: box-shadow 0.2s;"></div>
            </div>
        </div>
    </div>

    <!-- å…³å¡ 6ï¼šæƒé™é…ç½® -->
    <div id="step6" class="step-container bg-white">
        <div class="w-[400px] flex flex-col items-center">
            <h2 class="text-2xl font-bold mb-2 tracking-tighter kinetic-title inline-block origin-bottom">å…³ç¯æŒ‘æˆ˜</h2>
            <p class="text-sm text-gray-500 mb-10 text-center">æŠŠä¸‹é¢è¿™äº›å¼€å…³å…¨éƒ¨å…³æ‰ï¼Œ<br>å’±ä»¬å°±èƒ½è¿›å…¥æœ€åä¸€æ­¥äº†ã€‚</p>
            <div class="grid grid-cols-3 gap-x-8 gap-y-10" id="toggleGrid"></div>
            <button id="resetStep6Btn" class="mt-8 text-xs text-gray-400 hover:text-black transition-colors underline underline-offset-4 tracking-widest">
                å…¨ä¹±äº†ï¼Ÿç‚¹è¿™é‡ç½®
            </button>
            <button id="finalSubmitBtn" class="magnetic-btn mt-6 px-10 py-3 bg-black text-white rounded-full text-sm font-semibold tracking-widest opacity-30 pointer-events-none transition-all duration-500 hover:scale-105">
                ç»ˆäºæå®šäº†
            </button>
        </div>
    </div>

    <!-- å…³å¡ 7ï¼šé€¼çœŸçš„äººæœºéªŒè¯è”åˆä½“ -->
    <div id="step7" class="step-container bg-[#1a1a1a]">
        <div class="flex flex-col items-center relative h-[80px] w-[320px]">
            
            <!-- é˜¶æ®µ 1ï¼šCloudflare ç¯å¢ƒæ£€æµ‹ä¸­ -->
            <div id="cf-verifying" class="bg-[#222] p-4 border border-[#444] rounded-[3px] shadow-[0_0_15px_rgba(0,0,0,0.6)] flex items-center justify-between w-[320px] h-[80px] absolute top-0 left-1/2 transform -translate-x-1/2 transition-all duration-500">
                <div class="flex items-center gap-4">
                    <div class="w-6 h-6 border-[3px] border-[#555] border-t-[#fff] rounded-full animate-spin"></div>
                    <span class="text-[14px] font-normal text-white tracking-wide">Verify you are human</span>
                </div>
                <div class="flex flex-col items-end justify-center">
                    <span class="text-white font-bold text-xs tracking-widest flex items-center opacity-80">
                        <svg class="w-4 h-4 mr-1 text-orange-400" viewBox="0 0 24 24" fill="currentColor"><path d="M19.333 10.023A5.501 5.501 0 0014 5.5a5.498 5.498 0 00-4.885 2.877A4.5 4.5 0 004.5 13.5a4.5 4.5 0 00.354 1.758A4.001 4.001 0 005 23h13a4 4 0 001.333-7.758 5.467 5.467 0 000-5.219z"/></svg>
                        Cloudflare
                    </span>
                </div>
            </div>

            <!-- é˜¶æ®µ 2ï¼šåˆå§‹çš„ reCAPTCHA å‹¾é€‰æ¡† (Dark Mode) -->
            <div id="rc-widget" class="bg-[#222] p-2 pl-4 pr-3 border border-[#444] rounded-[3px] shadow-sm flex items-center justify-between w-[304px] h-[78px] absolute top-0 left-1/2 transform -translate-x-1/2 hidden opacity-0 transition-opacity duration-300">
                <div class="flex items-center gap-3">
                    <div id="rc-checkbox-real" class="magnetic-btn w-7 h-7 border-[2px] border-[#c1c1c1] rounded-[2px] bg-white cursor-pointer flex items-center justify-center transition-all">
                        <div id="rc-spin-real" class="w-5 h-5 border-[3px] border-[#f3f3f3] border-t-[#4a90e2] rounded-full animate-spin hidden"></div>
                        <!-- éªŒè¯æˆåŠŸåçš„ç»¿è‰²æ‰“å‹¾ -->
                        <svg id="rc-check-real" class="w-5 h-5 text-[#34a853] hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="4"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg>
                    </div>
                    <span class="text-[14px] font-normal text-white tracking-wide">è¿›è¡Œäººæœºèº«ä»½éªŒè¯</span>
                </div>
                <div class="flex flex-col items-center justify-center mt-1">
                    <svg class="w-8 h-8 text-[#4a90e2] mb-1 opacity-90" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z"/></svg>
                    <div class="text-[10px] text-[#999] tracking-tighter flex flex-col items-center leading-tight">
                        <span>reCAPTCHA</span>
                        <span class="scale-90 origin-top">éšç§æƒ - ä½¿ç”¨æ¡æ¬¾</span>
                    </div>
                </div>
            </div>

            <!-- æ‚¬æµ®çš„å›¾ç‰‡éªŒè¯ç å¼¹çª— (åŠ¨æ€æ›´æ–°å›¾åƒ) -->
            <div id="rc-popup" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white w-[380px] shadow-[0_10px_50px_rgba(0,0,0,0.8)] border border-[#ccc] z-[100] flex flex-col hidden opacity-0 transition-opacity duration-300 pointer-events-none">
                <div class="bg-[#1a73e8] text-white p-5 flex flex-col gap-1">
                    <span class="text-sm tracking-wider">è¯·é€‰æ‹©åŒ…å«</span>
                    <span id="rc-target-text" class="text-4xl font-bold tracking-widest mt-1 mb-1">è‡ªè¡Œè½¦</span>
                    <span class="text-sm tracking-wider">çš„æ‰€æœ‰å›¾å—</span>
                </div>
                <div class="p-[5px] bg-white relative">
                    <div class="grid grid-cols-4 gap-[2px] w-full aspect-square bg-white" id="rc-grid">
                        <!-- JS æ ¹æ®é¢˜åº“åŠ¨æ€ç”Ÿæˆ 16 ä¸ªæ–¹å—å¹¶åˆ†é…èƒŒæ™¯ -->
                    </div>
                    <p id="rc-error-msg" class="text-red-600 text-xs mt-2 h-4 opacity-0 transition-opacity absolute bottom-[-20px] left-2">è¯·é‡è¯•ã€‚</p>
                </div>
                <div class="p-3 mt-4 border-t border-gray-200 flex justify-between items-center bg-white">
                    <div class="flex gap-4 text-[#555]">
                        <svg class="w-6 h-6 cursor-pointer hover:text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        <svg class="w-6 h-6 cursor-pointer hover:text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                        <svg class="w-6 h-6 cursor-pointer hover:text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <button class="bg-[#1a73e8] hover:bg-[#1557b0] text-white px-8 py-2.5 text-sm font-semibold rounded-[2px] transition-colors" id="rc-verify-btn">è·³è¿‡</button>
                </div>
            </div>
            
        </div>
    </div>

    <!-- å…³å¡ 8ï¼šç²¾å‡†æ—¶æœº -->
    <div id="step8" class="step-container bg-white">
        <div class="w-[500px] flex flex-col items-center">
            <h2 class="text-3xl font-bold mb-2 text-black tracking-widest">æœ€åä¸€å…³</h2>
            <p class="text-sm text-gray-500 mb-12 text-center">
                è¯·åœ¨æ»‘å—ç§»åŠ¨è‡³ç»¿è‰²ç›®æ ‡åŒºåŸŸå†…æ—¶ï¼Œç‚¹å‡»â€œæäº¤â€æŒ‰é’®ã€‚
            </p>

            <div class="w-full h-8 bg-gray-100 rounded-full overflow-hidden relative mb-10 border border-gray-200 shadow-inner">
                <div id="target-zone" class="absolute top-0 h-full bg-green-400 opacity-80 transition-all duration-300" style="left: 70%; width: 10%;"></div>
                <div id="moving-slider" class="absolute top-0 left-0 w-1.5 h-full bg-black shadow-md" style="left: 0%;"></div>
            </div>

            <button id="final-timing-btn" class="magnetic-btn px-12 py-3 bg-black text-white rounded-full text-sm font-semibold hover:scale-105 transition-transform tracking-widest">
                æäº¤
            </button>
        </div>

        <div id="victoryText" class="absolute inset-0 flex flex-col items-center justify-center opacity-0 pointer-events-none transition-opacity duration-1000 z-[100] bg-white">
            <h1 class="text-6xl font-black mb-6 text-black tracking-widest">éªŒè¯é€šè¿‡</h1>
            <p class="text-gray-500 text-sm tracking-widest">æ‚¨å·²æˆåŠŸå®Œæˆæ‰€æœ‰å®‰å…¨æ ¡éªŒæ“ä½œã€‚</p>
        </div>
    </div>

    <script>
        // ==========================================
        // ğŸŒŸ æµä½“åŠ¨åŠ›å­¦æ ‡é¢˜
        // ==========================================
        let mouseX = 0;
        let skewTarget = 0;
        let currentSkewVal = 0;
        window.addEventListener('mousemove', (e) => {
            skewTarget = (e.clientX - mouseX) * 0.05;
            mouseX = e.clientX;
        });
        function animateSkew() {
            currentSkewVal += (skewTarget - currentSkewVal) * 0.1;
            document.querySelectorAll('.kinetic-title').forEach(el => {
                const clampedSkew = Math.max(-15, Math.min(15, -currentSkewVal));
                el.style.transform = `skewX(${clampedSkew}deg)`;
            });
            skewTarget *= 0.9;
            requestAnimationFrame(animateSkew);
        }
        animateSkew();

        // ==========================================
        // ğŸŒŸ ç£å¸æŒ‰é’®
        // ==========================================
        document.querySelectorAll('.magnetic-btn').forEach(btn => {
            btn.addEventListener('mousemove', function(e) {
                if(this.classList.contains('cursor-not-allowed') || this.classList.contains('pointer-events-none')) return;
                const rect = this.getBoundingClientRect();
                const x = e.clientX - rect.left - rect.width / 2;
                const y = e.clientY - rect.top - rect.height / 2;
                this.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
                this.style.transition = 'none';
            });
            btn.addEventListener('mouseleave', function() {
                this.style.transform = 'translate(0px, 0px)';
                this.style.transition = 'transform 0.4s cubic-bezier(0.25, 1, 0.5, 1)';
            });
        });

        // ==========================================
        // åè®®å†…å®¹ç”Ÿæˆ
        // ==========================================
        const tosContentStr = Array(30).fill(0).map((_, i) => `<p class="mb-4">ç¬¬ ${i+1} æ¡ï¼šéšä¾¿çœ‹çœ‹å°±è¡Œï¼Œå…¨æ˜¯åºŸè¯ã€‚ä½†åƒä¸‡åˆ«ç”¨æ»šè½®æ»‘å¤ªå¿«ï¼Œä¸ç„¶ä½ ä¼šè¢«æ¸…é›¶é‡æ¥çš„å“¦ã€‚è€å¿ƒç‚¹æ…¢æ…¢æ¥~</p>`).join('');
        document.getElementById('tosGhost').innerHTML = tosContentStr + '<div id="tosBottom" class="h-10 w-full"></div>';
        document.getElementById('tosBlurred').innerHTML = tosContentStr;
        document.getElementById('tosClear').innerHTML = tosContentStr;

        // ==========================================
        // ğŸŒŸ æ¢ç…§ç¯é€è§†
        // ==========================================
        const tosContainer = document.getElementById('tosContainer');
        const tosClear = document.getElementById('tosClear');
        tosContainer.addEventListener('mousemove', (e) => {
            if (!document.getElementById('step2').classList.contains('active')) return;
            const rect = tosContainer.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top + tosContainer.scrollTop; 
            tosClear.style.setProperty('--mx', `${x}px`);
            tosClear.style.setProperty('--my', `${y}px`);
        });

        // ==========================================
        // åŸºç¡€è®¾æ–½é…ç½®
        // ==========================================
        let failData = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };
        let totalFails = 0;
        const failCounterWidget = document.getElementById('failCounterWidget');
        const failCountDisplay = document.getElementById('failCount');
        let toastTimeout;

        function showToast(msg, durationMs = 3000) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.remove('hidden', 'toast-anim');
            void toast.offsetWidth; 
            toast.style.setProperty('--toast-duration', (durationMs / 1000) + 's');
            toast.classList.add('toast-anim');
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => {
                toast.classList.add('hidden');
                toast.classList.remove('toast-anim');
            }, durationMs);
        }

        function recordFail(stepNum, threshold, hintMessage, hintDuration = 5000) {
            failData[stepNum]++;
            totalFails++;
            failCounterWidget.classList.remove('hidden');
            failCountDisplay.textContent = totalFails;
            if (failData[stepNum] === threshold) showToast(hintMessage, hintDuration);
        }

        function goToStep(stepNum) {
            document.querySelectorAll('.step-container').forEach(el => el.classList.remove('active'));
            document.getElementById('step' + stepNum).classList.add('active');
            if(stepNum === 4) initScratchCard();
            if(stepNum === 7) initStep7();
            if(stepNum === 8) initStep8();
        }

        // ç‰©ç†æ‹‰ç»³
        const pullCord = document.getElementById('pullCord');
        let isCordDragging = false, startCordY = 0;
        pullCord.addEventListener('mousedown', (e) => {
            isCordDragging = true; startCordY = e.clientY;
            pullCord.style.cursor = 'grabbing'; pullCord.classList.remove('cord-swing');
        });
        window.addEventListener('mousemove', (e) => {
            if (!isCordDragging) return;
            const dy = Math.max(0, e.clientY - startCordY);
            pullCord.style.transform = `scaleY(${1 + dy/200})`;
            if (dy > 80) {
                isCordDragging = false; pullCord.style.cursor = 'grab';
                document.body.classList.toggle('dark-mode');
                pullCord.style.transform = ''; pullCord.classList.add('cord-swing');
            }
        });
        window.addEventListener('mouseup', () => {
            if (isCordDragging) {
                isCordDragging = false; pullCord.style.cursor = 'grab';
                pullCord.style.transform = ''; pullCord.classList.add('cord-swing');
            }
        });

        // èšå…‰ç¯èšç„¦
        const spotlightInputs = document.querySelectorAll('[data-spotlight="true"]');
        const spotlightOverlay = document.getElementById('spotlightOverlay');
        spotlightInputs.forEach(input => {
            input.addEventListener('focus', (e) => {
                document.body.classList.add('spotlight-active'); e.target.classList.add('spotlight-target');
                updateSpotlight(e);
            });
            input.addEventListener('blur', (e) => {
                document.body.classList.remove('spotlight-active'); e.target.classList.remove('spotlight-target');
            });
        });
        document.addEventListener('mousemove', (e) => {
            if (document.body.classList.contains('spotlight-active')) updateSpotlight(e);
        });
        function updateSpotlight(e) {
            spotlightOverlay.style.setProperty('--x', `${e.clientX}px`);
            spotlightOverlay.style.setProperty('--y', `${e.clientY}px`);
        }

        // å…³å¡ 1ï¼šé˜²è¯¯è§¦å…³é—­
        const runawayBtn = document.getElementById('runawayBtn');
        let lastMousePos = { x: 0, y: 0 }; let lastMouseTime = Date.now();
        document.addEventListener('mousemove', (e) => {
            if (!document.getElementById('step1').classList.contains('active')) return;
            const now = Date.now(); const dt = Math.max(now - lastMouseTime, 1);
            const dx = e.clientX - lastMousePos.x; const dy = e.clientY - lastMousePos.y;
            const speed = Math.sqrt(dx*dx + dy*dy) / dt; 
            const btnRect = runawayBtn.getBoundingClientRect();
            const btnCenter = { x: btnRect.left + btnRect.width/2, y: btnRect.top + btnRect.height/2 };
            const distToBtn = Math.sqrt(Math.pow(e.clientX - btnCenter.x, 2) + Math.pow(e.clientY - btnCenter.y, 2));

            if (speed > 0.3 && distToBtn < 150) {
                const parentRect = runawayBtn.parentElement.getBoundingClientRect();
                const newX = Math.random() * (parentRect.width - 40) - (parentRect.width/2 - 20);
                const newY = Math.random() * (parentRect.height - 40) - (parentRect.height/2 - 20);
                runawayBtn.style.transform = `translate(${newX}px, ${newY}px)`;
                recordFail(1, 10, "è·‘å¤ªå¿«å•¦ï¼é¼ æ ‡æŒªæ…¢ç‚¹ï¼Œä¸ç„¶æŒ‰é’®ä¼šå®³æ€•çš„ã€‚");
            }
            lastMousePos = { x: e.clientX, y: e.clientY }; lastMouseTime = now;
        });
        runawayBtn.addEventListener('click', () => { goToStep(2); });

        // å…³å¡ 2ï¼šé˜…è¯»é™é€Ÿ
        const agreeBtn = document.getElementById('agreeBtn');
        let isTosRead = false;
        
        // é™åˆ¶é¼ æ ‡æ»šè½®
        tosContainer.addEventListener('wheel', (e) => {
            if (!document.getElementById('step2').classList.contains('active')) return;
            if (e.deltaY > 60) {
                e.preventDefault(); tosContainer.scrollTo({ top: 0, behavior: 'smooth' });
                showToast("æ»‘å¤ªå¿«å•¦ï¼ç½šä½ é‡å¤´å†æ¥~");
                recordFail(2, 5, "æç¤ºï¼šé¼ æ ‡æ»šè½®å®¹æ˜“ç¿»è½¦ï¼Œå»ºè®®ç”¨é”®ç›˜çš„ä¸‹æ–¹å‘é”®(â†“)æ…¢æ…¢å¾€ä¸‹çœ‹ã€‚");
            }
        }, { passive: false });

        // ç›‘å¬æ»šåŠ¨å®Œæˆ
        tosContainer.addEventListener('scroll', () => {
            if (tosContainer.scrollHeight - tosContainer.scrollTop - tosContainer.clientHeight < 10) {
                if (!isTosRead) {
                    isTosRead = true;
                    agreeBtn.classList.remove('bg-gray-200', 'text-gray-400', 'cursor-not-allowed');
                    agreeBtn.classList.add('bg-black', 'text-white', 'cursor-pointer');
                }
            }
        });

        // ==========================================
        // ã€å·²ä¿®å¤ã€‘æ·»åŠ å…¨å±€é”®ç›˜äº‹ä»¶ç›‘å¬ï¼Œç¡®ä¿æŒ‰ä¸‹ç®­å¤´ï¼ˆâ†“/â†‘ï¼‰å¯ä»¥æ»šåŠ¨
        // å› ä¸ºå…¨å±€ body è¢«è®¾ç½®äº† overflow: hiddenï¼Œä¸”å®¹å™¨é»˜è®¤æ— ç„¦ç‚¹ï¼Œ
        // å¿…é¡»é€šè¿‡è„šæœ¬æ¥ä»£åŠ³æŒ‰é”®çš„æ»šåŠ¨è¡Œä¸ºã€‚
        // ==========================================
        window.addEventListener('keydown', (e) => {
            if (document.getElementById('step2').classList.contains('active')) {
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    tosContainer.scrollTop += 40; // æ¨¡æ‹Ÿå‘ä¸‹æŒ‰é”®æ»šåŠ¨é‡
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    tosContainer.scrollTop -= 40; // æ¨¡æ‹Ÿå‘ä¸ŠæŒ‰é”®æ»šåŠ¨é‡
                }
            }
        });

        agreeBtn.addEventListener('click', () => { if (isTosRead) goToStep(3); });

        // å…³å¡ 3ï¼šç»ˆç«¯é…ç½®
        const phoneSlider = document.getElementById('phoneSlider'), phoneDisplay = document.getElementById('phoneDisplay');
        const sendCodeBtn = document.getElementById('sendCodeBtn'), step3State1 = document.getElementById('step3-state1');
        const step3State2 = document.getElementById('step3-state2'), confirmPhoneDisplay = document.getElementById('confirmPhoneDisplay');
        const smsCodeInput = document.getElementById('smsCodeInput'), verifyCodeBtn = document.getElementById('verifyCodeBtn'), backToPhoneBtn = document.getElementById('backToPhoneBtn');

        phoneSlider.addEventListener('input', (e) => { phoneDisplay.textContent = e.target.value; });
        phoneSlider.addEventListener('change', (e) => {
            let val = parseInt(e.target.value), offset = Math.floor(Math.random() * 31) - 15;
            if (offset === 0) offset = 5; 
            val += offset; phoneSlider.value = val; phoneDisplay.textContent = val;
            showToast("å“å‘€ï¼Œæ‰‹æŠ–äº†ä¸€ä¸‹ï¼Œå·ç å˜äº†ã€‚");
        });

        sendCodeBtn.addEventListener('click', () => {
            step3State1.classList.add('opacity-0');
            setTimeout(() => {
                step3State1.classList.add('hidden'); step3State2.classList.remove('hidden');
                confirmPhoneDisplay.textContent = phoneSlider.value; 
                setTimeout(() => step3State2.classList.remove('opacity-0'), 50);
            }, 500);
            showToast("å‡è£…çŸ­ä¿¡å·²ç»å‘å‡ºå»å•¦~");
        });

        backToPhoneBtn.addEventListener('click', () => {
            step3State2.classList.add('opacity-0');
            setTimeout(() => {
                step3State2.classList.add('hidden'); step3State1.classList.remove('hidden');
                setTimeout(() => step3State1.classList.remove('opacity-0'), 50);
            }, 500);
            smsCodeInput.value = ''; 
            recordFail(3, 3, "å·å·å‘Šè¯‰ä½ ï¼ŒéªŒè¯ç å…¶å®æ˜¯ 000000ï¼Œåˆ«å¡«é”™äº†ã€‚", 8000);
        });

        verifyCodeBtn.addEventListener('click', () => {
            if (smsCodeInput.value === '000000') goToStep(4);
            else {
                showToast("éªŒè¯ç ä¸å¯¹å“¦ï¼Œå†çŒœçŒœï¼Ÿ");
                recordFail(3, 3, "å·å·å‘Šè¯‰ä½ ï¼Œæ­£ç¡®çš„éªŒè¯ç æ˜¯ 000000ã€‚", 8000);
            }
        });

        // å…³å¡ 4ï¼šå¯†é’¥é…ç½®
        const pwdInput = document.getElementById('passwordInput'), rulesContainer = document.getElementById('rulesContainer');
        const pwdNextBtn = document.getElementById('pwdNextBtn'), secretPwdDisplay = document.getElementById('secretPasswordDisplay');
        const currentMonth = new Date().toLocaleString('en-US', { month: 'short' });
        const pwdRules = [
            { id: 'r1', text: 'è‡³å°‘å¾—æœ‰ 8 ä½å§', check: (v) => v.length >= 8 },
            { id: 'r2', text: 'å¿…é¡»å¸¦ä¸ªå¤§å†™å­—æ¯', check: (v) => /[A-Z]/.test(v) },
            { id: 'r3', text: 'å¯†ç é•¿åº¦å¾—æ˜¯ä¸ªè´¨æ•°ï¼ˆæ¯”å¦‚ 11ï¼Œ13ï¼Œ17ï¼‰', check: (v) => { const num = v.length; if (num <= 1) return false; for(let i=2; i<=Math.sqrt(num); i++) if(num%i===0) return false; return true; }},
            { id: 'r4', text: `å¿…é¡»åŒ…å«å½“å‰çš„è‹±æ–‡æœˆä»½ç¼©å†™ (${currentMonth})`, check: (v) => v.includes(currentMonth) },
            { id: 'r5', text: 'å¯†ç é‡Œæ‰€æœ‰çš„æ•°å­—åŠ èµ·æ¥å¾—åˆšå¥½ç­‰äº 25', check: (v) => { const nums = v.match(/\d/g); if (!nums) return false; return nums.reduce((acc, curr) => acc + parseInt(curr), 0) === 25; }}
        ];
        let currentRuleIndex = 0;

        function renderRule(index, isSuccess) {
            const rule = pwdRules[index]; let el = document.getElementById(rule.id);
            if (!el) {
                el = document.createElement('div'); el.id = rule.id;
                el.className = 'flex items-center gap-2 opacity-0 transition-opacity duration-700 text-gray-400';
                el.innerHTML = `<div class="w-4 h-4 rounded-full border border-current flex items-center justify-center icon-box transition-colors"></div><span>${rule.text}</span>`;
                rulesContainer.appendChild(el); void el.offsetWidth; el.classList.remove('opacity-0');
            }
            const iconBox = el.querySelector('.icon-box');
            if (isSuccess) {
                el.classList.replace('text-gray-400', 'text-black'); iconBox.classList.add('bg-black', 'border-black');
                iconBox.innerHTML = `<svg class="w-3 h-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg>`;
            } else {
                el.classList.replace('text-black', 'text-gray-400'); iconBox.classList.remove('bg-black', 'border-black'); iconBox.innerHTML = '';
            }
        }
        renderRule(0, false);

        pwdInput.addEventListener('input', (e) => {
            const val = e.target.value;
            secretPwdDisplay.textContent = val.length > 0 ? val.substring(0, 10) + (val.length>10?'...':'') : '****';
            if (val.includes('!') || val.includes('?') || val.includes('ï¼') || val.includes('ï¼Ÿ')) {
                pwdInput.classList.remove('shake-anim'); void pwdInput.offsetWidth; pwdInput.classList.add('shake-anim');
            }
            let allPassedSoFar = true;
            for (let i = 0; i <= currentRuleIndex; i++) {
                const passed = pwdRules[i].check(val); renderRule(i, passed); if (!passed) allPassedSoFar = false;
            }
            if (allPassedSoFar && currentRuleIndex < pwdRules.length - 1) {
                currentRuleIndex++; renderRule(currentRuleIndex, false); allPassedSoFar = false; 
            }
            if (allPassedSoFar && currentRuleIndex === pwdRules.length - 1) {
                pwdNextBtn.classList.remove('opacity-0', 'pointer-events-none');
            } else { pwdNextBtn.classList.add('opacity-0', 'pointer-events-none'); }
        });

        pwdInput.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace' || e.key === 'Delete') recordFail(4, 20, `åˆ«ä¹±åˆ å•¦ï¼æç¤ºï¼šæŠŠå½“å‰æœˆä»½ç¼©å†™ ${currentMonth} åŠ è¿›å»ï¼Œå¹¶è®©æ‰€æœ‰æ•°å­—å‡‘å¤Ÿ 25ã€‚`, 8000);
        });

        // åˆ®åˆ®ä¹ç”»å¸ƒ
        const scratchCanvas = document.getElementById('scratchCanvas');
        let scratchCtx, isScratching = false;

        function initScratchCard() {
            scratchCtx = scratchCanvas.getContext('2d');
            scratchCanvas.width = scratchCanvas.offsetWidth; scratchCanvas.height = scratchCanvas.offsetHeight;
            let gradient = scratchCtx.createLinearGradient(0, 0, scratchCanvas.width, scratchCanvas.height);
            gradient.addColorStop(0, '#e5e7eb'); gradient.addColorStop(0.5, '#d1d5db'); gradient.addColorStop(1, '#9ca3af');
            scratchCtx.fillStyle = gradient; scratchCtx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);
            scratchCtx.font = "12px sans-serif"; scratchCtx.fillStyle = "#6b7280"; scratchCtx.textAlign = "center";
            scratchCtx.fillText("åˆ®å¼€å›¾å±‚", scratchCanvas.width/2, scratchCanvas.height/2 + 4);
            scratchCtx.globalCompositeOperation = 'destination-out';
        }

        function scratch(e) {
            if(!isScratching) return;
            const rect = scratchCanvas.getBoundingClientRect(), x = e.clientX - rect.left, y = e.clientY - rect.top;
            scratchCtx.beginPath(); scratchCtx.arc(x, y, 12, 0, Math.PI * 2); scratchCtx.fill();
        }

        scratchCanvas.addEventListener('mousedown', () => isScratching = true);
        window.addEventListener('mouseup', () => isScratching = false);
        scratchCanvas.addEventListener('mousemove', scratch);

        pwdNextBtn.addEventListener('click', () => goToStep(5));

        // å…³å¡ 5ï¼šè¡Œä¸ºéªŒè¯
        const captchaDot = document.getElementById('captchaDot'), captchaPath = document.getElementById('captchaPath'), step5Svg = document.getElementById('captchaSvg');
        let isDragging = false; const dotStartPos = { left: 40, top: 65 }; 

        captchaDot.addEventListener('mousedown', () => { isDragging = true; captchaDot.style.cursor = 'grabbing'; captchaDot.style.boxShadow = '0 0 0 4px rgba(0,0,0,0.1)'; });
        window.addEventListener('mouseup', () => {
            if (isDragging) { isDragging = false; captchaDot.style.cursor = 'grab'; captchaDot.style.boxShadow = 'none'; resetDot(); }
        });
        window.addEventListener('mousemove', (e) => {
            if (!isDragging || !document.getElementById('step5').classList.contains('active')) return;
            const svgRect = step5Svg.getBoundingClientRect(), x = e.clientX - svgRect.left, y = e.clientY - svgRect.top;
            captchaDot.style.left = (x - 10) + 'px'; captchaDot.style.top = (y - 10) + 'px';
            captchaDot.style.pointerEvents = 'none'; const elUnderMouse = document.elementFromPoint(e.clientX, e.clientY); captchaDot.style.pointerEvents = 'auto'; 

            if (elUnderMouse !== captchaPath) {
                isDragging = false; captchaDot.style.cursor = 'grab'; captchaDot.style.boxShadow = 'none'; showToast("å“å‘€ï¼Œæ‰å‡ºå»äº†ï¼Œé‡æ¥é‡æ¥ã€‚");
                captchaDot.classList.add('bg-red-500'); setTimeout(() => captchaDot.classList.remove('bg-red-500'), 300);
                resetDot(); recordFail(5, 5, "æç¤ºï¼šç¨³ä½ç¨³ä½ï¼åˆ«å¿ƒæ€¥ï¼Œé¡ºç€çº¿æ…¢æ…¢æ»‘å°±è¡Œã€‚", 5000); return;
            }
            if (x > 440) { isDragging = false; showToast("æ¼‚äº®ï¼é¡ºåˆ©è¿‡å…³ã€‚"); setTimeout(() => goToStep(6), 1000); }
        });
        function resetDot() {
            captchaDot.style.transition = 'all 0.3s ease'; captchaDot.style.left = dotStartPos.left + 'px'; captchaDot.style.top = dotStartPos.top + 'px';
            setTimeout(() => { captchaDot.style.transition = 'box-shadow 0.2s'; }, 300);
        }

        // å…³å¡ 6ï¼šæƒé™æ§åˆ¶
        const toggleGrid = document.getElementById('toggleGrid'), finalSubmitBtn = document.getElementById('finalSubmitBtn'), resetStep6Btn = document.getElementById('resetStep6Btn');
        const gridSize = 3; let togglesState = [1, 1, 1, 1, 1, 1, 1, 1, 1];
        function renderToggles() {
            toggleGrid.innerHTML = '';
            togglesState.forEach((state, index) => {
                const label = document.createElement('label'); label.className = 'flex flex-col items-center gap-2';
                const checkbox = document.createElement('input'); checkbox.type = 'checkbox'; checkbox.className = 'ios-toggle'; checkbox.checked = state === 1;
                checkbox.addEventListener('click', (e) => { e.preventDefault(); handleToggleClick(index); });
                const span = document.createElement('span'); span.className = 'text-xs text-gray-400 font-medium'; span.textContent = `å¼€å…³ 0${index + 1}`;
                label.appendChild(checkbox); label.appendChild(span); toggleGrid.appendChild(label);
            });
            checkFinalWin();
        }
        function handleToggleClick(index) {
            const row = Math.floor(index / gridSize); const col = index % gridSize;
            flip(row, col); flip(row - 1, col); flip(row + 1, col); flip(row, col - 1); flip(row, col + 1);
            renderToggles(); recordFail(6, 25, "å·å·å‘Šè¯‰ä½ ä¸ªé€šå…³ç§˜ç±ï¼šå…ˆç‚¹å››ä¸ªè§’çš„å¼€å…³ï¼Œæœ€åå†ç‚¹ä¸­é—´é‚£ä¸ªã€‚", 8000);
        }
        function flip(r, c) { if (r >= 0 && r < gridSize && c >= 0 && c < gridSize) { const idx = r * gridSize + c; togglesState[idx] = togglesState[idx] === 1 ? 0 : 1; } }
        function checkFinalWin() {
            if (togglesState.every(s => s === 0)) { finalSubmitBtn.classList.remove('opacity-30', 'pointer-events-none'); finalSubmitBtn.classList.add('cursor-pointer'); } 
            else { finalSubmitBtn.classList.add('opacity-30', 'pointer-events-none'); finalSubmitBtn.classList.remove('cursor-pointer'); }
        }
        renderToggles();
        resetStep6Btn.addEventListener('click', () => { togglesState = [1, 1, 1, 1, 1, 1, 1, 1, 1]; renderToggles(); });
        finalSubmitBtn.addEventListener('click', () => { goToStep(7); });

        // å…³å¡ 7ï¼šé€¼çœŸçš„äººæœºéªŒè¯ç»„åˆé€»è¾‘
        let isStep7Init = false;
        function initStep7() {
            if (isStep7Init) return;
            isStep7Init = true;
            
            const cfVerifying = document.getElementById('cf-verifying');
            const rcWidget = document.getElementById('rc-widget');
            const rcCheckbox = document.getElementById('rc-checkbox-real');
            const rcSpin = document.getElementById('rc-spin-real');
            const rcCheckReal = document.getElementById('rc-check-real');
            const rcPopup = document.getElementById('rc-popup');
            const rcGrid = document.getElementById('rc-grid');
            const rcVerifyBtn = document.getElementById('rc-verify-btn');
            const rcErrorMsg = document.getElementById('rc-error-msg');
            const rcTargetText = document.getElementById('rc-target-text');
            
            let verifyAttempts = 0;

            // æ›´æ–°äº†ç”¨æˆ·æä¾›çš„çº¢ç»¿ç¯å’Œæ–‘é©¬çº¿çš„é«˜æ¸…çœŸå®ç½‘å›¾
            const challenges = [
                { target: 'è‡ªè¡Œè½¦', imgUrl: 'https://images.unsplash.com/photo-1485965120184-e220f721d03e?auto=format&fit=crop&w=400&q=80' },
                { target: 'çº¢ç»¿ç¯', imgUrl: 'https://img.mistmu.top/PicGo/20260227062110HjYo6K.webp' },
                { target: 'æ–‘é©¬çº¿', imgUrl: 'https://img.mistmu.top/PicGo/20260227062119ePIvo9.webp' }
            ];

            // åŠ¨æ€åŠ è½½ä¹å®«æ ¼é¢˜ç›®çš„å‡½æ•°
            function loadChallenge(index) {
                rcGrid.innerHTML = '';
                const chal = challenges[index];
                rcTargetText.textContent = chal.target;
                
                for (let i = 0; i < 16; i++) {
                    const col = i % 4;
                    const row = Math.floor(i / 4);
                    
                    const wrapper = document.createElement('div');
                    wrapper.className = 'rc-tile-wrapper';
                    
                    const tile = document.createElement('div');
                    tile.className = 'rc-tile';
                    // åŠ¨æ€æ›¿æ¢èƒŒæ™¯å›¾ç‰‡
                    tile.style.backgroundImage = `url('${chal.imgUrl}')`;
                    tile.style.backgroundPosition = `${col * 33.333}% ${row * 33.333}%`;
                    
                    const checkIcon = document.createElement('div');
                    checkIcon.className = 'rc-tile-check';
                    checkIcon.innerHTML = `<svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="4"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg>`;
                    
                    wrapper.appendChild(tile);
                    wrapper.appendChild(checkIcon);
                    
                    wrapper.addEventListener('click', () => {
                        wrapper.classList.toggle('selected');
                        const selectedCount = document.querySelectorAll('.rc-tile-wrapper.selected').length;
                        rcVerifyBtn.textContent = selectedCount > 0 ? 'éªŒè¯' : 'è·³è¿‡';
                    });
                    rcGrid.appendChild(wrapper);
                }
                rcVerifyBtn.textContent = 'è·³è¿‡';
            }

            // 1. æ¨¡æ‹Ÿ Cloudflare éªŒè¯åŠ è½½å»¶è¿Ÿ (åœç•™ 3 ç§’å±•ç¤ºçœŸå®æ„Ÿ)
            setTimeout(() => {
                cfVerifying.classList.add('opacity-0');
                setTimeout(() => {
                    cfVerifying.classList.add('hidden');
                    
                    // 2. è°ƒå‡º Google reCAPTCHA
                    rcWidget.classList.remove('hidden');
                    void rcWidget.offsetWidth; 
                    rcWidget.classList.remove('opacity-0');
                }, 500);
            }, 3000); 

            // åˆå§‹åŒ–ç¬¬ä¸€å¥—è€ƒé¢˜
            loadChallenge(0);

            // ç‚¹å‡»å¤é€‰æ¡†è§¦å‘éªŒè¯å¼¹çª—
            rcCheckbox.addEventListener('click', () => {
                if (rcSpin.classList.contains('hidden') === false || rcCheckReal.classList.contains('hidden') === false) return; // é˜²æ­¢é‡å¤ç‚¹å‡»æˆ–å·²éªŒè¯çŠ¶æ€ä¸‹ç‚¹å‡»
                rcSpin.classList.remove('hidden');
                
                setTimeout(() => {
                    rcSpin.classList.add('hidden');
                    rcPopup.classList.remove('hidden');
                    void rcPopup.offsetWidth;
                    rcPopup.classList.remove('opacity-0');
                    rcPopup.style.pointerEvents = 'auto';
                }, 800);
            });

            // éªŒè¯æŒ‰é’®ç‚¹å‡»é€»è¾‘
            rcVerifyBtn.addEventListener('click', () => {
                const selectedCount = document.querySelectorAll('.rc-tile-wrapper.selected').length;
                
                if (selectedCount === 0) {
                    rcErrorMsg.textContent = "è¯·é€‰æ‹©æ‰€æœ‰åŒ¹é…çš„å›¾åƒã€‚";
                    rcErrorMsg.classList.remove('opacity-0');
                    setTimeout(() => rcErrorMsg.classList.add('opacity-0'), 2000);
                    return;
                }

                verifyAttempts++;

                // å‰ä¸¤æ¬¡æ•…æ„åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¹¶åˆ·æ–°ä¸åŒè€ƒé¢˜
                if (verifyAttempts < 3) {
                    rcVerifyBtn.textContent = 'éªŒè¯ä¸­...';
                    setTimeout(() => {
                        rcErrorMsg.textContent = "è¯·é‡è¯•ã€‚";
                        rcErrorMsg.classList.remove('opacity-0');
                        
                        // å¼¹çª—æŠ–åŠ¨ç‰¹æ•ˆ
                        rcPopup.classList.add('shake-anim');
                        setTimeout(() => rcPopup.classList.remove('shake-anim'), 400);

                        // ç¨å¾®å»¶è¿Ÿä¸€ä¸‹ï¼ŒåŠ è½½ä¸‹ä¸€å¥—é¢˜åº“
                        setTimeout(() => {
                            loadChallenge(verifyAttempts);
                        }, 500);
                        
                        recordFail(7, 2, "AI è§‰å¾—ä½ çš„çœ¼åŠ›ä¸å¤ªè¡Œï¼Œæ¢ä¸ªé¢˜ç›®å†è€ƒè€ƒä½ ã€‚", 5000);
                        setTimeout(() => rcErrorMsg.classList.add('opacity-0'), 2000);
                    }, 600);
                } else {
                    // ç¬¬ä¸‰æ¬¡é€šè¿‡éªŒè¯ï¼Œç›´æ¥æ˜¾ç¤º reCAPTCHA ç»¿å‹¾ï¼Œåˆ é™¤ Cloudflare æˆåŠŸé¡µ
                    rcVerifyBtn.textContent = 'éªŒè¯ä¸­...';
                    setTimeout(() => {
                        rcPopup.classList.add('opacity-0');
                        rcPopup.style.pointerEvents = 'none';
                        
                        // è®©å¤é€‰æ¡†æ˜¾ç¤ºç»¿è‰²å‹¾å‹¾
                        rcCheckbox.classList.replace('border-[#c1c1c1]', 'border-transparent');
                        rcCheckReal.classList.remove('hidden');
                        
                        setTimeout(() => {
                            rcPopup.classList.add('hidden');
                            
                            showToast("æˆåŠŸè¯æ˜æ‚¨ä¸æ˜¯æœºå™¨äººï¼");
                            
                            setTimeout(() => {
                                failCounterWidget.classList.add('hidden');
                                goToStep(8);
                            }, 1000); // ç›´æ¥å‰å¾€ç¬¬å…«å…³
                            
                        }, 500);
                    }, 800);
                }
            });
        }

        // å…³å¡ 8ï¼šç²¾å‡†æ—¶æœº
        const step8 = document.getElementById('step8');
        const movingSlider = document.getElementById('moving-slider');
        const targetZone = document.getElementById('target-zone');
        const finalTimingBtn = document.getElementById('final-timing-btn');
        const victoryText = document.getElementById('victoryText');
        
        let timingRaf = null;
        let sliderPos = 0;
        let sliderDir = 1;
        let sliderSpeed = 1.2; 
        let targetStart = 70;
        let targetWidth = 10;
        let isTimingActive = false;

        function initStep8() {
            if (isTimingActive) return;
            isTimingActive = true;
            sliderPos = 0;
            sliderDir = 1;
            randomizeTarget();
            startTimingLoop();
        }

        function randomizeTarget() {
            targetWidth = Math.floor(Math.random() * 6) + 8; // 8% - 13% å®½åº¦çš„å®‰å…¨åŒº
            targetStart = Math.floor(Math.random() * 60) + 20; // 20% - 80% çš„éšæœºä½ç½®
            targetZone.style.left = targetStart + '%';
            targetZone.style.width = targetWidth + '%';
        }

        function startTimingLoop() {
            function loop() {
                if (!isTimingActive) return;
                
                sliderPos += sliderSpeed * sliderDir;
                if (sliderPos >= 100) {
                    sliderPos = 100;
                    sliderDir = -1;
                } else if (sliderPos <= 0) {
                    sliderPos = 0;
                    sliderDir = 1;
                }
                
                movingSlider.style.left = `calc(${sliderPos}% - 3px)`; 
                
                timingRaf = requestAnimationFrame(loop);
            }
            timingRaf = requestAnimationFrame(loop);
        }

        finalTimingBtn.addEventListener('click', () => {
            if (!isTimingActive) return;
            
            const sliderCenter = sliderPos;
            const targetEnd = targetStart + targetWidth;
            
            if (sliderCenter >= targetStart && sliderCenter <= targetEnd) {
                // æˆåŠŸåˆ¤å®š
                isTimingActive = false;
                cancelAnimationFrame(timingRaf);
                movingSlider.style.backgroundColor = '#22c55e'; // å˜æˆç»¿è‰²ä»£è¡¨æˆåŠŸ
                
                setTimeout(() => {
                    victoryText.classList.remove('opacity-0', 'pointer-events-none');
                }, 300);
            } else {
                // å¤±è´¥åˆ¤å®š
                showToast("æœªå¯¹å‡†ç›®æ ‡åŒºåŸŸï¼Œè¯·é‡è¯•ã€‚");
                recordFail(8, 3, "æç¤ºï¼šæ»‘å—æœ‰ä¸€å®šçš„ç§»åŠ¨é€Ÿåº¦ï¼Œè¯·é¢„åˆ¤æå‰é‡è¿›è¡Œç‚¹å‡»ã€‚", 4000);
                
                // æƒ©ç½šæœºåˆ¶ï¼šæœªå¯¹å‡†åˆ™è½»å¾®æé€Ÿï¼Œå¹¶éšæœºæ›´æ¢å®‰å…¨åŒºä½ç½®
                sliderSpeed = Math.min(sliderSpeed + 0.15, 3.0);
                randomizeTarget();
                
                // æŒ‰é’®éœ‡åŠ¨åé¦ˆ
                finalTimingBtn.classList.remove('shake-anim');
                void finalTimingBtn.offsetWidth;
                finalTimingBtn.classList.add('shake-anim');
            }
        });

    </script>
</body>
</html>